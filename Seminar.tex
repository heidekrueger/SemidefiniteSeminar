\documentclass[11pt]{beamer}
\usetheme{Rochester}

\usepackage[utf8]{inputenc}
\usepackage[german]{babel}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{enumitem}
\setitemize{label=\usebeamerfont*{itemize item}
	\usebeamercolor[fg]{itemize item}
	\usebeamertemplate{itemize item}}
\usepackage{pgfpages}
\setbeameroption{show notes}
\setbeameroption{show notes on second screen}

\author{Fin Bauer and Stefan Heidekrüger}
\title{Semidefinite Programming}
%\subtitle{}
%\logo{}
%\institute{}
%\date{}
%\subject{}
%\setbeamercovered{transparent}
\setbeamertemplate{navigation symbols}{}

\begin{document}
	\maketitle
\begin{frame}
	\frametitle{Outline}
	\tableofcontents
\end{frame}
\section{Introduction}	
	\begin{frame}
		\frametitle{What Is Semidefinite Programming?}
	\begin{block}{\vspace*{-3ex}}
		\begin{equation*}
		\begin{aligned}
		\min_X \quad\langle C,X \rangle &:= Tr(CX)=\sum_{i=1}^{n}\sum_{j=1}^{n}C_{ij}X_{ij}\\
		\text{s.t.}\quad\langle A_i,X\rangle&\:= b_i,\quad i=1,\dots,m\\
		X&\:\succeq 0
		\end{aligned}
		\end{equation*}
	\end{block}
	$C$, $A_i$, $X$ $\in \mathbb{R}^{nxn}$ symmetric \newline $X \succeq 0$ $\hat{=}$ X is positive semidefinite (p.s.d.)
	\end{frame}
	\begin{frame}
		\frametitle{An Easy Example}
		\begin{equation*}
		C=\begin{pmatrix}
		1 & 2 \\
		2 & 9 \\
		\end{pmatrix},\; A_1=\begin{pmatrix}
		1 & 0 \\
		0 & 3 \\
		\end{pmatrix},\; A_2=\begin{pmatrix}
		0 & 2 \\
		2 & 3 \\
		\end{pmatrix},\; b_1=11,\; b_2=19
		\end{equation*}
		\pause
		\begin{block}{\vspace*{-3ex}}
		\begin{equation*}
		\begin{aligned}
		\min\quad && x_{11}+2x_{21}+2x_{12}+9x_{22}\\
		\text{s.t.}\quad&& x_{11}+x_{22}= & \:11\\
		&&  2x_{21}+2x_{12}+3x_{22}= & \:19\\
		&& X=\begin{pmatrix}
		x_{11}& x_{12}\\
		x_{21}& x_{22}\\
		\end{pmatrix}\succeq&\: 0
		\end{aligned}
		\end{equation*}
		\end{block}
	\end{frame}
	\begin{frame}
		\frametitle{Problem Session}
		\begin{columns}
			\begin{column}{0.5\textwidth}
				\begin{block}{Problem 1}
					Are Linear Programs (LP) and Convex Quadratically Constrained Quadratic Programs (CQCQP) Semidefinite Programs (SDP)?
				\end{block}
			\end{column}
			\begin{column}{0.5\textwidth}
				\begin{block}{Problem 2}
					max cut
				\end{block}
			\end{column}
		\end{columns}
		\begin{columns}
			\begin{column}{0.5\textwidth}
				\begin{block}{Problem 3}
					lovasz
				\end{block}
			\end{column}
			\begin{column}{0.5\textwidth}
				\begin{block}{Problem 4}
					\vspace{4.4ex} Is a certain optimization problem a SDP and what does it model?\vspace{4.5ex}
				\end{block}
			\end{column}
		\end{columns}
	\end{frame}
	\begin{frame}
		\frametitle{Problem 1: \newline Have I Ever Seen Semidefinite Programming Before?}
		\begin{itemize}[leftmargin=-0.3cm]
		\item Linear Programming\\
		\begin{columns}
			\begin{column}{0.5\textwidth}
				\begin{block}{Linear Program}
					\scriptsize
					\abovedisplayskip=0pt
					\abovedisplayshortskip=0pt 
					\belowdisplayskip=0pt
					\belowdisplayshortskip=0pt 
					\begin{equation*}
					\begin{aligned}
					\min_x\quad  b_0^Tx+c_0\quad\\
					\text{s.t.}\quad  b_i^Tx+c_i\leq&  \:0\text{,\quad i in 1,...,n}\\
					 x\geq& \:0
					\end{aligned}
					\end{equation*}
				\end{block}
			\end{column}
			\begin{column}{0.5\textwidth}
				\begin{block}{Hint}
					Diagonal Matrix
				\end{block}
			\end{column}
		\end{columns}
		\item Convex Quadratically Constrained Quadratic Programming\\
		\begin{columns}
		\begin{column}{0.5\textwidth}
		\begin{block}{CQCQP}
		\scriptsize
		\abovedisplayskip=0pt
		\abovedisplayshortskip=0pt 
		\belowdisplayskip=0pt
		\belowdisplayshortskip=0pt 
		\begin{equation*}
		\begin{aligned}
		\min\quad &x^TA_0x+b_0^Tx+c_0\\
		\text{s.t.}\quad &x^TA_ix+b_i^Tx+c_i\leq 0\text{,\quad i in 1,...,n}
		\end{aligned}
		\end{equation*}
		\end{block}
		\end{column}
		\begin{column}{0.5\textwidth}
			\begin{block}{Hint}
			\scriptsize
			\begin{equation*}
			\begin{aligned}
			\text{Given }A_i=M_i^TM_i\\
			\text{then }x^TA_ix+b_i^Tx+c_i\leq 0 \\
			\begin{pmatrix}
			I & M_ix\\
			x^TM_i^T & -c_i-b_i^Tx\\
			\end{pmatrix}
			\succeq 0
			\end{aligned}
			\end{equation*}
			\end{block}
		\end{column}
		\end{columns}
		\end{itemize}
	\end{frame}
	\begin{frame}
		\frametitle{Optimization Hierarchy}
		\begin{block}{\vspace{-3ex}}
			\centering \large LP $<$ CQCQP $<$ SDP $<$ Convex Programming
		\end{block}
	\end{frame}


\section{Some Theory}
\subsection{Duality}
	\begin{frame}
		\frametitle{What's the Dual?}
		\begin{block}{Primal Problem in Standard Form}
			\begin{equation*}
			\inf_X\{Tr(CX);Tr(A_iX)=b_i\;(i=1,...,m),\;X\in \mathcal{S}^+_n\}
			\end{equation*}
		\end{block}
		\begin{block}{Dual Problem in Standard Form}
			\begin{equation*}
			\sup_{y,S}\{b^Ty;\sum_{i=1}^{m}y_iA_i+S=C,\;S\in \mathcal{S}^+_n,y\in\mathbb{R}^m\}
			\end{equation*}
		\end{block}
	\end{frame}
	\begin{frame}
		\frametitle{Weak and Strong Duality}
	\end{frame}
	\begin{frame}
		\frametitle{Example with Duality Gap}
	\end{frame}
\subsection{Optimality}
	\begin{frame}
		\frametitle{When is the Solution Optimal?}
		\begin{block}{Optimality Conditions}
			\begin{equation*}
			\begin{aligned}
			Tr(A_iX)&=b_i,\quad X\succeq 0,\quad i=1,...,m\\
			\sum_{i=1}^{m}y_iA_i+S&=C,\quad S\succeq 0\\
			XS&=0
			\end{aligned}
			\end{equation*}
		\end{block}
	\end{frame}
\section{Algorithms}
\subsection{Interior Points}
\begin{frame}
	\frametitle{bla}
\end{frame}
\section{Applications}
\subsection{The Lovász number}
\begin{frame}
	\frametitle{The Lovász number}
	\begin{block}{Definition (SDP-variant)}
		Let $G=(V,E)$ be a graph.
	\end{block}
\end{frame}
\subsection{Max Cut}
\begin{frame}
	\frametitle{Problem 2: \newline What is MAX CUT?}
	\only<1>{\emph{Group presentation time.}}
	\only<2>{
	\begin{block}{IQP Model}
	Problem (MC) should be on the board now.
	\end{block}}
	\note<1->{\begin{equation*}\max \frac{1}{2}\sum_{i<j}w_{ij}(1-y_iy_j), \qquad s.t. y_i\in\{1,-1\}\end{equation*} }
\end{frame}

	\begin{frame}
		\note{\begin{itemize}\item 1995 \item Approx: 0.87856 \item eq. algorithm already existed, but bound wasn't known.\end{itemize}}
		\frametitle{An SDP-approximation algorithm (Goermans-Williamson)}
		Outline
		\begin{itemize}
			\item Relax (MC) into a QP (P)
			\item Find approximation bound of QP
			\item Show: equivalent SQP (SQ) to (P)
			\item Strong duality holds for (SQ) (ommitted)
			\item Solve SQP's dual in polynomial time
		\end{itemize}		
	\end{frame}

	\begin{frame}\frametitle{QP Relaxation of (MC)}
		\begin{block}{(P) }
			\begin{equation*}
				\begin{aligned}
				W_P^*:= \max \ &\frac{1}{2}\sum_{i<j}w_{ij}(1-v_i^Tv_j)\\
				s.t. \ &v_i \in \mathbb{S}^n \qquad \forall i\in V
				\end{aligned}
			\end{equation*}
		\end{block}
	    \note{relaxation gives upper bound}
	\end{frame}


	\begin{frame}\frametitle{A randomized algorithm using (P)}
		\begin{block}<1->{}
		\begin{itemize}
				\item[1.]{Solve (P) to get vectors $v_i$}
				\item[2.]{Sample $r \sim UNIFORM(\mathbb S^n)$}
				\item[3.]{Set $S:=\{i | v_i^Tr\geq 0\}$}
		\end{itemize}
		\end{block}
		\only<2>{\begin{block}{For cut $W$ obtained this way:}
		
			$$E[W] = \sum_{i<j}w_{ij}\frac{\arccos(v_i^Tv_j)}{\pi}$$
		
		\end{block}}
	\end{frame}

	\begin{frame}\frametitle{A bound given by $E[W]$}
		\begin{block}<1->{Theorem}
			$$ E[W] \geq \alpha \frac{1}{2} \sum_{i<j}w_{ij}(1-v_i^Tv_j)$$
			with
			$$ \alpha:= \min_{0\leq \Theta \leq \pi}\frac{2}{\pi}\frac{\Theta}{1-\cos \Theta} > .87856\dots$$
		\end{block}
		\begin{block}<2->{Corollary}
			$$ E[W] \geq \alpha W_{P}^* \geq \alpha W_{MC}^* $$
		\end{block}	
	\end{frame}

	\begin{frame}\frametitle{SDP formulation of (P)}
		\begin{block}<1->{(SD) }
			\begin{equation*}
				\begin{aligned}
				W_P^*:= \max \ &\frac{1}{2}\sum_{i<j}w_{ij}(1-y_{ij})\\
				s.t. \ &y_{ii} = 1 \qquad \forall i\in V\\
					 & Y \ \textnormal{sym. pos. sem. def.}
				\end{aligned}
			\end{equation*}
		\end{block}
	    \begin{block}<2>{How is this an SDP? Rewrite the objective!}
	    $$ = \frac{1}{4}\sum_{i\in V}\sum_{j\in V}w_{ij}(1-y_{ij})$$
	    $$ = \frac{1}{2}W_{tot} - \frac{1}{4}\langle W,Y \rangle$$
	    \end{block}
	\end{frame}

	\begin{frame}\frametitle{How is $(P) \Leftrightarrow (SP)?$}
	    \begin{itemize}
	    	\item Recall that a symmetric matrix $A\in \mathbb R^n$ is positive semidefinite iff for some $m\leq n$
	    	$$\exists B\in\mathbb R^{m\times n}: A = B^TB$$
	    	\item Given pos. semidef. $A$, such a $B$ can be found in $\mathcal O(n^3)$ using incomplete Cholesky decomposition.
	    	\item Interpret $Y$ in (SP) as the Gram-Matrix of vectors $v_i$ in (P)
	    \end{itemize}
	\end{frame}

	\begin{frame}\frametitle{(Almost) Solving (SQ) in polynomial time}
		\begin{block}{}
		\begin{itemize}
			\item For this particular Problem, strong duality holds.
			\item Using the dual, a cut with weight at least $W^*_{SQ}-\varepsilon$ can be found in $\mathcal O(\sqrt{n}(\log W_{tot}+\log\frac{1}{\varepsilon})$ iterations using an interior point algorithm. Each iteration can be implemented in $\mathcal O(n^3)$
			\item This cut is a 0.878 approximation to $W_{MC}^*$
		\end{itemize}
		\end{block}
		\note{Algo: Alizadeh 1995}
	\end{frame}

	\begin{frame}\frametitle{'Quality' of the approximation}
		\begin{block}{Can $\alpha>0.87856$ be improved?}
			No! The relaxation is tight.
			\begin{itemize}
				\item For $C_5: E[W] \approx .884 W^*_{MC}$ 
				\item For Peterson graph $\approx .8787$
				\item Examples are known such that $E[W] < .8786 W^*_{MC}$
			\end{itemize}
		\end{block}
		\begin{block}{How does the algorithm do in practice?}
			\begin{itemize}
				\item Usually within $4\%$ of $W^*_MC$
				\item 'Almost always' within $9\%$
			\end{itemize}
		\end{block}
	
	\end{frame}



\subsection{Machine Learning}
\begin{frame}
	\frametitle{Problem 4:\newline What is modeled here and is it a SDP?}
	\begin{block}{\vspace*{-3ex}}
		\begin{equation*}
		\begin{aligned}
		\max\quad& \rho\\
		\text{s.t.}\quad&(a_i-c)^TE(a_i-c)\leq 1\;\forall i\\
		&(b_j-c)^TE(b_j-c)\geq \rho^2\;\forall j\\
		& E\in\mathbb{S}^n_+
		\end{aligned}
		\end{equation*}
	\end{block}
\end{frame}
\begin{frame}
	\frametitle{Classification - Using SDP to tell two things apart (1)}
	\begin{block}{Ellipsoid}
		\begin{equation*}
			\mathcal{E}=\{x\in\mathbb{R}^n;\:(x-c)^TE(x-c)<=1,\;E \text{ is p.s.d.}\}
		\end{equation*}
	\end{block}
	\begin{block}{First idea for SDP}
		\begin{equation*}
		\begin{aligned}
		\max\quad& \rho\\
		\text{s.t.}\quad&(a_i-c)^TE(a_i-c)\leq 1\;\forall i\\
		&(b_j-c)^TE(b_j-c)\geq \rho^2\;\forall j\\
		& E\in\mathbb{S}^n_+
		\end{aligned}
		\end{equation*}
	\end{block}
\end{frame}
\begin{frame}
	\frametitle{Classification - Using SDP to tell two things apart (2)}
	\begin{equation*}
	\begin{aligned}
	\max\quad& \rho\\
	\text{s.t.}\quad&(1,a_i)^T\bar{E}(1,a_i)\leq 1\;\forall i\\
	&(1,b_j)^T\bar{E}(1,b_j)\geq \rho^2\;\forall j\\
	& E\in\mathbb{S}^{n+1}_+
	\end{aligned}
	\end{equation*}
\end{frame}
\end{document}